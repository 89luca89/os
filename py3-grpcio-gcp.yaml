# Generated from https://pypi.org/project/grpcio-gcp/
package:
  name: py3-grpcio-gcp
  version: 0.2.2
  epoch: 2
  description: gRPC extensions for Google Cloud Platform
  copyright:
    - license: Apache-2.0
  dependencies:
    runtime:
      - py3-grpcio
      - python-3

environment:
  contents:
    packages:
      - build-base
      - busybox
      - ca-certificates-bundle
      - py3-build-base
      - py3-grpcio-tools
      - py3-setuptools
      - python-3
      - wolfi-base

pipeline:
  - uses: git-checkout
    with:
      repository: https://github.com/GoogleCloudPlatform/grpc-gcp-python
      tag: v${{package.version}}
      expected-commit: 8ef890243664ebd95ae0225cdf87e7442b570f9e

  - runs: |
      cd src
      # From src/setup.sh
      cp -f ../template/version.py version.py
      python3 -m grpc_tools.protoc -I. --python_out=grpc_gcp/proto grpc_gcp.proto

  - name: Python Build
    uses: py/pip-build-install
    with:
      source: ./src

  - uses: strip

update:
  enabled: true
  github:
    identifier: GoogleCloudPlatform/grpc-gcp-python
    strip-prefix: v
